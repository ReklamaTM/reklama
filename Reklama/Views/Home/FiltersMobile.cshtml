@using System.Globalization
@model Reklama.ViewModels.Filters.FiltersViewModel

@{
    ViewBag.Title = "IndexMobile";
    Layout = "~/Views/_Layout/_Mobile.cshtml";
}

<div class="bg-silver">
    <div class="main-header">
        <h3>Фильтры</h3>
    </div>
    <div class="main-container p-3">
        <div class="row">
            <div class="col-12">
                <form id="formCreate" action="/Home/Filter" method="post">
                    <div class="form-group">
                        <label for="city-field">Город:</label>
                        @Html.DropDownListFor(x => x.CityId, new SelectList((Model.Cities), "Id", "Name"), "Выберите город", new { @class = "form-control", id = "city-field" })
                    </div>
                    <div class="form-group">
                        <label for="description-field">Текс объявления:</label>
                        @Html.TextBoxFor(x => x.Description, new { Class = "form-control", id = "description-field" })
                    </div>
                    <div class="form-group">
                        <label for="rooms-field">Кол-во комнат:</label>
                        @Html.TextBoxFor(x => x.Rooms, new { Class = "form-control", id = "rooms-field", type = "number", min = "0", max = "999" })
                    </div>
                    <div class="form-group">
                        <div class="row">
                            <div class="col-6">
                                <label for="square-from-field">Площадь от м<sup>2</sup>:</label>
                                @Html.TextBoxFor(x => x.SquareFrom, new { Class = "form-control", type = "number", id = "square-from-field", min = "0", max = "999" })
                            </div>
                            <div class="col-6">
                                <label for="square-to-field">Площадь до м<sup>2</sup>:</label>
                                @Html.TextBoxFor(x => x.SquareTo, new { Class = "form-control", type = "number", id = "square-to-field", min = "0", max = "999" })
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="row">
                            <div class="col-6">
                                <label for="level-from-field">Этаж от:</label>
                                @Html.TextBoxFor(x => x.LevelFrom, new { Class = "form-control", type = "number", id = "level-from-field", min = "0", max = "999" })
                            </div>
                            <div class="col-6">
                                <label for="level-to-field">Этаж до:</label>
                                @Html.TextBoxFor(x => x.LevelTo, new { Class = "form-control", type = "number", id = "level-to-field", min = "0", max = "999" })
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <p class="m-0 font-weight-bold"><label for="city-field">Упорядочить по:</label></p>
                        <div class="form-check form-check-inline">
                            @Html.RadioButtonFor(x => x.DirectionSort, 1, new { @class = "form-check-input", id = "radio1" })
                            <label class="form-check-label" for="radio1">Возрастанию</label>
                        </div>
                        <div class="form-check form-check-inline">
                            @Html.RadioButtonFor(x => x.DirectionSort, 2, new { @class = "form-check-input", id = "radio2" })
                            <label class="form-check-label" for="radio2">Убыванию</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <p class="m-0 font-weight-bold"><label for="city-field">Сортировать по:</label></p>
                        <div class="form-check form-check-inline">
                            @Html.RadioButtonFor(x => x.FieldSort, 1, new { @class = "form-check-input", id = "radio3" })
                            <label class="form-check-label" for="radio3">Цена</label>
                        </div>
                        <div class="form-check form-check-inline">
                            @Html.RadioButtonFor(x => x.FieldSort, 2, new { @class = "form-check-input", id = "radio4" })
                            <label class="form-check-label" for="radio4">Дата</label>
                        </div>
                        <div class="form-check form-check-inline">
                            @Html.RadioButtonFor(x => x.FieldSort, 3, new { @class = "form-check-input", id = "radio5" })
                            <label class="form-check-label" for="radio5">Количеству м<sup>2</sup></label>
                        </div>
                        <div class="form-check form-check-inline">
                            @Html.RadioButtonFor(x => x.FieldSort, 4, new { @class = "form-check-input", id = "radio6" })
                            <label class="form-check-label" for="radio6">Цене за м<sup>2</sup></label>
                        </div>
                    </div>
                    <div class="form-group">
                        @Html.AntiForgeryToken()
                        <div class="row">
                            <div class="col-6">
                                <button type="submit" class="btn btn-lg btn-primary w-100">
                                    <i class="fa fa-filter"></i> Найти
                                </button>
                            </div>
                            <div class="col-6">
                                <a class="btn btn-lg btn-outline-secondary w-100" href="@Url.Action("FiltersMobile", "Home")">
                                    <i class="fa fa-redo-alt"></i> Сбросить
                                </a>
                            </div>
                        </div>
                    </div>

                </form>
            </div>
            <div class="col-12">
                <div class="row">
                    <div class="col-12">
                        @if (Model.IsFiltered)
                        {
                            if (Model.Realties != null && Model.Realties.Any())
                            {
                                <div class="main-pub-items">
                                    @foreach (var realty in Model.Realties)
                                    {
                                    <div class="item blue">
                                        <div class="bg blue"></div>
                                        <div class="img">
                                            @if (realty.Photos != null && realty.Photos.Count != 0)
                                            {
                                                <div class="icon-wrapper">
                                                    <img data-toggle="modal" data-target="@("#item-modal-"+realty.Id)" src="@string.Concat("/", ProjectConfiguration.Get.FilePaths["realty_thumb"], "/", realty.Photos.OrderBy(x => x.CreatedAt).First().Link)" />
                                                </div>

                                    <!-- Modal for images-->
                                                <div class="modal fade" id="@("item-modal-"+realty.Id)" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                                    <div class="modal-dialog" role="document">
                                                        <div class="modal-content">
                                                            <div class="modal-body">
                                                                <div id="@("carouselExampleInterval"+realty.Id)" class="carousel slide" data-ride="carousel">
                                                                    <div class="carousel-inner">
                                                                        @foreach (var photo in realty.Photos)
                                                                        {
                                                                            if (photo == realty.Photos.First())
                                                                            {
                                                                                <div class="carousel-item active">
                                                                                    <img src="@string.Concat("/Images/Realty/", photo.Link)" class="d-block w-100">
                                                                                </div>
                                                                            }
                                                                            else
                                                                            {
                                                                                <div class="carousel-item">
                                                                                    <img src="@string.Concat("/Images/Realty/", photo.Link)" class="d-block w-100">
                                                                                </div>
                                                                            }
                                                                        }
                                                                    </div>
                                                                    <a class="carousel-control-prev" href="@("#carouselExampleInterval"+realty.Id)" role="button" data-slide="prev">
                                                                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                                                        <span class="sr-only">Previous</span>
                                                                    </a>
                                                                    <a class="carousel-control-next" href="@("#carouselExampleInterval"+realty.Id)" role="button" data-slide="next">
                                                                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                                                        <span class="sr-only">Next</span>
                                                                    </a>
                                                                </div>
                                                            </div>
                                                            <div class="modal-footer">
                                                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Закрыть</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            }
                                            else
                                            {
                                                <div class="icon-wrapper blue">
                                                    <i class="fa fa-home fa-3x"></i>
                                                </div>
                                            }
                                        </div>
                                        <div class="info">
                                            <p>
                                                <i class="fa fa-map-marker"></i> @realty.City, @realty.Street
                                            </p>
                                            <p>
                                                <i class="fa fa-cube"></i>
                                                @if (realty.FloorCount != null)
                                                {
                                                    @realty.FloorCount <span> комн.квартира</span>
                                                }
                                                @if (realty.Square != null)
                                                {
                                                    <span>,</span> @realty.Square <span> кв.м</span>
                                                }
                                                @if (realty.Floor != null)
                                                {
                                                    <span>,</span> @realty.Floor <span> эт.</span>
                                                }
                                            </p>
                                            <p>
                                                @if (realty.Currency != null && realty.Price != null)
                                                {
                                                    <i class="fa fa-shopping-cart"></i> @Math.Round(((decimal)realty.Currency.Rate * realty.Price.Value), 2).ToString("0.#####", CultureInfo.InvariantCulture)
                                                }
                                                else
                                                {
                                                    <i class="fa fa-shopping-cart"></i> <span>0</span>
                                                }
                                                <i class="fa fa-dollar-sign"></i>
                                            </p>
                                        </div>

                                    </div>




                                    }
                                </div>
                                
                            }
                            else
                            {
                                <h3 class="text-center">Нет данных</h3>
                            }
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    @*<script src="~/Scripts/jquery.validate.min.js"></script>*@
    @*<script src="~/Scripts/jquery.validate.unobtrusive.min.js"></script>*@



    @Scripts.Render("~/bundles/jqueryval")
    @* @Scripts.Render("~/Scripts/ajaxupload.js")*@
    @Scripts.Render("~/Scripts/Realty.js")
    @Scripts.Render("~/Scripts/common.js")

    @Scripts.Render("~/Scripts/jquery-te-1.4.0.min.js")
    @Styles.Render("~/Content/jquery-te-1.4.0.css")



    @*<script src="~/Scripts/jquery-ui-1.11.4.min.js"></script>
        <script>
            jQuery(document).ready(function () {
                jQuery('#rooms-field').spinner();
            });
        </script>*@
}

@section Styles {
    @*<link href="~/Content/jquery-ui.css" rel="stylesheet" />*@
}
